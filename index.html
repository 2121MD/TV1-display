<script>
        // --- CONFIGURATION ---
        
        // 1. YOUR GOOGLE SLIDES URL (I fixed this for you using the link you provided)
        const SLIDE_URL = "https://docs.google.com/presentation/d/e/2PACX-1vQwjmE1FkRhNx5nQYTXnp6GILgPBUGh0L1qHyrPiBH92eyt_2XiUNhbWCRengOVVzJ5IXHZqP8S1bWI/embed?start=true&loop=true&delayms=10000";
        
        // 2. THE BUS STOP ID (This must be a number!)
        const SITE_ID = "1606"; 
        
        // 3. FILTER (Only show buses to Väsby)
        const BUS_FILTER = "Upplands Väsby";

        // 4. TIMING (How long to show each screen in milliseconds)
        const SLIDE_DURATION = 30000; // 30 seconds for slides
        const BUS_DURATION = 15000;   // 15 seconds for bus times

        // --- LOGIC ---
        const slideContainer = document.getElementById('slide-container');
        const busContainer = document.getElementById('bus-container');
        const slideFrame = document.getElementById('slide-frame');
        const busList = document.getElementById('bus-list');

        // Set the slide URL immediately
        slideFrame.src = SLIDE_URL;

        function showSlides() {
            busContainer.style.display = 'none';
            slideContainer.style.display = 'block';
            setTimeout(showBuses, SLIDE_DURATION);
        }

        function showBuses() {
            slideContainer.style.display = 'none';
            busContainer.style.display = 'block';
            fetchBusTimes(); 
            setTimeout(showSlides, BUS_DURATION);
        }

        async function fetchBusTimes() {
            busList.innerHTML = "Loading buses...";
            try {
                // Using a CORS proxy to allow browser requests to SL
                // We use corsproxy.io because it is generally more stable for schools
                const targetUrl = `https://transport.integration.sl.se/v1/sites/${SITE_ID}/departures?transport_authority_id=1`;
                const proxyUrl = "https://corsproxy.io/?" + encodeURIComponent(targetUrl);
                
                const response = await fetch(proxyUrl);
                
                if (!response.ok) throw new Error("Network response was not ok");

                const data = await response.json();
                
                let html = "";
                const buses = data.departures || [];
                let count = 0;

                buses.forEach(bus => {
                    // Check if it is a BUS and matches our filter
                    if (bus.line.transport_mode === 'BUS' && 
                        bus.destination.toLowerCase().includes(BUS_FILTER.toLowerCase())) {
                        
                        if (count < 4) { // Show max 4 buses
                            html += `
                            <div class="bus-row">
                                <div class="bus-line">${bus.line.designation}</div>
                                <div class="bus-dest">${bus.destination}</div>
                                <div class="bus-time">${bus.display}</div>
                            </div>`;
                            count++;
                        }
                    }
                });

                if (count === 0) {
                    html = "<div style='text-align:center; margin-top: 20px;'>No buses to " + BUS_FILTER + " found.</div>";
                }
                
                busList.innerHTML = html;

            } catch (e) {
                busList.innerHTML = "<div style='color:red; text-align:center;'>Error loading data. <br> Check internet connection.</div>";
                console.error(e);
            }
        }

        // Start the loop
        setTimeout(showBuses, SLIDE_DURATION); 

    </script>
